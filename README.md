# CosmoVid — Full-Stack Web App

**CosmoVid** is a full-stack web application to download TikTok videos in HD (with or without watermark) and as MP3. Built with **Next.js**, **Express**, **TailwindCSS**, and **TypeScript**.

## Features

- **Homepage:** Paste TikTok URL and get download links (MP4 HD with/without watermark, MP3).
- **Backend API:** `POST /api/download` with rate limiting and caching.
- **Responsive:** Mobile-first, works on all devices.
- **Premium UI:** Minimalist, Gucci-inspired typography and spacing.
- **Pages:** Home (downloader), FAQ (how it works, legal disclaimer), About/Contact.
- **i18n:** English and Arabic with RTL support.
- **Ad slots:** Placeholder areas for Google AdSense (header, sidebar, result section).
- **SEO:** Meta tags, sitemap, robots.txt, SSR.
- **Analytics:** Google Analytics placeholder (GA4).
- **Error handling:** Invalid/private TikTok URLs return clear messages.

## Tech Stack

| Layer    | Stack                          |
|----------|---------------------------------|
| Frontend | Next.js 14, React, TailwindCSS, TypeScript |
| Backend  | Node.js, Express, TypeScript    |
| Hosting  | DigitalOcean Droplet (Ubuntu 22.04), Nginx, PM2 |

## Project Structure

```
├── frontend/          # Next.js app (App Router)
│   ├── src/
│   │   ├── app/       # Routes, layout, sitemap, robots
│   │   ├── components/
│   │   ├── contexts/
│   │   ├── lib/
│   │   └── locales/   # en.json, ar.json
│   └── package.json
├── backend/           # Express API
│   ├── src/
│   │   ├── routes/    # /api/download
│   │   ├── services/  # TikTok fetch + cache
│   │   └── server.ts
│   └── package.json
├── DEPLOYMENT.md      # DigitalOcean, Nginx, PM2, SSL
└── README.md
```

## Quick Start

### Backend

The backend uses **yt-dlp** to fetch TikTok video links. Install it first:

```bash
# macOS (Homebrew)
brew install yt-dlp

# Ubuntu/Debian
sudo apt update && sudo apt install -y yt-dlp
# Or install latest: sudo curl -L https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -o /usr/local/bin/yt-dlp && sudo chmod a+rx /usr/local/bin/yt-dlp

# Or with pip
pip install yt-dlp
```

Then start the API:

```bash
cd backend
npm install
npm run build
npm start
# Or: npm run dev
```

Runs at `http://localhost:4000`. Health: `GET /health`. Download: `POST /api/download` with body `{ "url": "https://www.tiktok.com/@user/video/123" }`.

### Frontend

```bash
cd frontend
npm install
cp .env.example .env.local   # if you have one
npm run dev
```

Open `http://localhost:3000`. Set `NEXT_PUBLIC_API_URL=http://localhost:4000` if the API runs elsewhere.

### Environment Variables

**Backend** (optional):

- `PORT` — default `4000`
- `YT_DLP_PATH` — path to yt-dlp binary if not in PATH (e.g. `/usr/local/bin/yt-dlp`)

**Frontend:**

- `NEXT_PUBLIC_API_URL` — backend base URL (e.g. `http://localhost:4000` or `https://api.yourdomain.com`)
- `NEXT_PUBLIC_SITE_URL` — site URL for sitemap/OG (e.g. `https://yourdomain.com`)
- `NEXT_PUBLIC_GA_ID` — Google Analytics 4 Measurement ID (e.g. `G-XXXXXXXXXX`)

## API

### POST /api/download

**Request:**

```json
{ "url": "https://www.tiktok.com/@username/video/1234567890123456789" }
```

**Response (success):**

```json
{
  "success": true,
  "title": "Video title",
  "author": "username",
  "cover": "https://...",
  "links": {
    "mp4HdWatermark": "https://...",
    "mp4HdNoWatermark": "https://...",
    "mp3": "https://..."
  }
}
```

**Response (error):**

```json
{
  "success": false,
  "links": {},
  "error": "Video not found or is private. Please check the URL."
}
```

Rate limit: 30 requests per minute per IP. Responses are cached per video ID.

## TikTok service (yt-dlp)

The backend uses **yt-dlp** to extract TikTok video and audio URLs. Install yt-dlp on the server (see Quick Start). If yt-dlp is not in your PATH, set `YT_DLP_PATH` to the binary path. The service parses yt-dlp’s JSON output and returns MP4 (with/without watermark) and MP3 links.

## Deployment

See **[DEPLOYMENT.md](./DEPLOYMENT.md)** for:

1. Creating a DigitalOcean Droplet (Ubuntu 22.04)
2. Installing Node.js, Nginx, PM2
3. Cloning the repo and running backend + frontend
4. Nginx reverse proxy and optional API subdomain
5. SSL with Let's Encrypt
6. Google AdSense and Analytics

## SEO & Scaling

- **SEO:** Default meta title/description target “TikTok downloader HD, no watermark.” Sitemap and robots.txt are generated by Next.js (`/sitemap.xml`, `/robots.txt`).
- **Scaling:** The app is structured so you can add more platforms later (e.g. Instagram Reels, YouTube Shorts) via new API routes and services without changing the frontend flow.

## License

MIT. Use for personal projects. Respect TikTok’s Terms of Service and copyright; this project is not affiliated with TikTok.
# CosmoVid
